{
    "info": {
        "_postman_id": "fhir-transformer-integration",
        "name": "FHIR Transformer Integration Tests",
        "description": "Comprehensive Integration tests for FHIR Transformer API",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    },
    "auth": {
        "type": "basic",
        "basic": [
            {
                "key": "password",
                "value": "password",
                "type": "string"
            },
            {
                "key": "username",
                "value": "admin",
                "type": "string"
            }
        ]
    },
    "item": [
        {
            "name": "Tenant Management",
            "item": [
                {
                    "name": "Onboard Tenant",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200 or 400 (already exists)\", function () {",
                                    "    if (pm.response.code === 200) {",
                                    "        pm.response.to.have.status(200);",
                                    "    } else {",
                                    "        pm.response.to.have.status(400);",
                                    "        pm.expect(pm.response.text()).to.include(\"exists\");",
                                    "    }",
                                    "});",
                                    "if (pm.response.code === 200) {",
                                    "    var jsonData = pm.response.json();",
                                    "    pm.test(\"Tenant ID matches\", function () {",
                                    "        pm.expect(jsonData.tenantId).to.eql(\"tenant1\");",
                                    "    });",
                                    "    pm.test(\"Tenant Name matches\", function () {",
                                    "        pm.expect(jsonData.name).to.eql(\"Test Hospital\");",
                                    "    });",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"tenantId\": \"tenant1\",\n    \"password\": \"password123\",\n    \"name\": \"Test Hospital\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/tenants/onboard",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "tenants",
                                "onboard"
                            ]
                        }
                    }
                },
                {
                    "name": "Get All Tenants",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "pm.test(\"Returns list\", function () {",
                                    "    var jsonData = pm.response.json();",
                                    "    pm.expect(jsonData).to.be.an('array');",
                                    "    pm.expect(jsonData.length).to.be.above(0);",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/api/tenants",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "tenants"
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "HL7 to FHIR Conversions",
            "item": [
                {
                    "name": "Async ADT^A01 (Admission)",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"currentTransactionId\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 202\", function () {",
                                    "    pm.response.to.have.status(202);",
                                    "});",
                                    "pm.test(\"Response body indicates async processing\", function () {",
                                    "    var jsonData = pm.response.json();",
                                    "    pm.expect(jsonData.status).to.eql(\"Accepted\");",
                                    "    pm.expect(jsonData.message).to.eql(\"Processing asynchronously\");",
                                    "});",
                                    "pm.test(\"Transaction ID matches MSH-10\", function () {",
                                    "    var jsonData = pm.response.json();",
                                    "    var expectedId = pm.environment.get(\"currentTransactionId\");",
                                    "    pm.expect(jsonData.transactionId).to.eql(expectedId);",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "text/plain",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "MSH|^~\\&|HIS|RIH|EKG|EkG|199904140038||ADT^A01|{{currentTransactionId}}|P|2.5\rPID|1||100||DOE^JOHN||19700101|M||||||||||1000"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/v2-to-fhir",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "v2-to-fhir"
                            ]
                        }
                    }
                },
                {
                    "name": "Sync ADT^A01 (Full Patient + Encounter)",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"syncAdt01Id\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var jsonData = pm.response.json();",
                                    "pm.test(\"Is FHIR Bundle\", function () {",
                                    "    pm.expect(jsonData.resourceType).to.eql(\"Bundle\");",
                                    "});",
                                    "pm.test(\"Bundle ID Matches MSH-10\", function () {",
                                    "    var expectedId = pm.environment.get(\"syncAdt01Id\");",
                                    "    pm.expect(jsonData.id).to.eql(expectedId);",
                                    "});",
                                    "pm.test(\"Contains Patient\", function () {",
                                    "    var patient = jsonData.entry.find(e => e.resource.resourceType === \"Patient\");",
                                    "    pm.expect(patient).to.not.be.undefined;",
                                    "    pm.expect(patient.resource.name[0].family).to.eql(\"DOE\");",
                                    "});",
                                    "pm.test(\"Contains Encounter\", function () {",
                                    "    var encounter = jsonData.entry.find(e => e.resource.resourceType === \"Encounter\");",
                                    "    pm.expect(encounter).to.not.be.undefined;",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "text/plain",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "MSH|^~\\&|HIS|RIH|EKG|EkG|199904140038||ADT^A01|{{syncAdt01Id}}|P|2.5\rPID|1||100||DOE^JOHN||19700101|M||||||||||1000\rPV1|1|I"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/v2-to-fhir-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "v2-to-fhir-sync"
                            ]
                        }
                    }
                },
                {
                    "name": "Sync ADT^A08 (Patient Only - No PV1)",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"syncAdt08Id\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var jsonData = pm.response.json();",
                                    "pm.test(\"Bundle ID Matches MSH-10\", function () {",
                                    "    var expectedId = pm.environment.get(\"syncAdt08Id\");",
                                    "    pm.expect(jsonData.id).to.eql(expectedId);",
                                    "});",
                                    "pm.test(\"Contains Patient\", function () {",
                                    "    var patient = jsonData.entry.find(e => e.resource.resourceType === \"Patient\");",
                                    "    pm.expect(patient).to.not.be.undefined;",
                                    "    pm.expect(patient.resource.name[0].given[0]).to.eql(\"JANE\");",
                                    "});",
                                    "pm.test(\"Does NOT Contain Encounter\", function () {",
                                    "    var encounter = jsonData.entry.find(e => e.resource.resourceType === \"Encounter\");",
                                    "    pm.expect(encounter).to.be.undefined;",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "text/plain",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "MSH|^~\\&|HIS|RIH|EKG|EkG|199904140038||ADT^A08|{{syncAdt08Id}}|P|2.5\rPID|1||101||DOE^JANE||19800101|F||||||||||1001"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/v2-to-fhir-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "v2-to-fhir-sync"
                            ]
                        }
                    }
                },
                {
                    "name": "Sync Unknown Gender (PID-8)",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"syncUnknownId\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var jsonData = pm.response.json();",
                                    "pm.test(\"Bundle ID Matches MSH-10\", function () {",
                                    "    var expectedId = pm.environment.get(\"syncUnknownId\");",
                                    "    pm.expect(jsonData.id).to.eql(expectedId);",
                                    "});",
                                    "pm.test(\"Gender is Unknown\", function () {",
                                    "    var patient = jsonData.entry.find(e => e.resource.resourceType === \"Patient\");",
                                    "    pm.expect(patient.resource.gender).to.eql(\"unknown\");",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "text/plain",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "MSH|^~\\&|HIS|RIH|EKG|EkG|199904140038||ADT^A08|{{syncUnknownId}}|P|2.5\rPID|1||102||SMITH^ALEX||19900101|X||||||||||1002"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/v2-to-fhir-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "v2-to-fhir-sync"
                            ]
                        }
                    }
                },
                {
                    "name": "Sync ADT^A01 (Patient + Diagnosis)",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"syncDg1Id\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var jsonData = pm.response.json();",
                                    "pm.test(\"Contains Condition\", function () {",
                                    "    var condition = jsonData.entry.find(e => e.resource.resourceType === \"Condition\");",
                                    "    pm.expect(condition).to.not.be.undefined;",
                                    "    pm.expect(condition.resource.code.coding[0].code).to.eql(\"E11.9\");",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "text/plain",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "MSH|^~\\&|HIS|RIH|EKG|EkG|199904140038||ADT^A01|{{syncDg1Id}}|P|2.5\rPID|1||103||CONDORN^JANE\rDG1|1|I10|E11.9^Type 2 diabetes mellitus without complications|Type 2 diabetes mellitus|W"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/v2-to-fhir-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "v2-to-fhir-sync"
                            ]
                        }
                    }
                },
                {
                    "name": "Sync ADT^A01 (Patient + Allergy)",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"syncAl1Id\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var jsonData = pm.response.json();",
                                    "pm.test(\"Contains AllergyIntolerance\", function () {",
                                    "    var allergy = jsonData.entry.find(e => e.resource.resourceType === 'AllergyIntolerance');",
                                    "    pm.expect(allergy).to.not.be.undefined;",
                                    "    pm.expect(allergy.resource.code.coding[0].code).to.eql('Z88.1');",
                                    "    pm.expect(allergy.resource.category[0]).to.eql('medication');",
                                    "    pm.expect(allergy.resource.reaction[0].severity).to.eql('moderate');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "text/plain",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "MSH|^~\\&|HIS|RIH|EKG|EkG|199904140038||ADT^A01|{{syncAl1Id}}|P|2.5\rPID|1||103||CONDORN^JANE\rAL1|1|DA|Z88.1^Penicillin^CD|MO|Hives"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/v2-to-fhir-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "v2-to-fhir-sync"
                            ]
                        }
                    }
                },
                {
                    "name": "Sync ADT^A01 (Patient + Observation)",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"syncObxId\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var jsonData = pm.response.json();",
                                    "pm.test(\"Contains Observation with Date\", function () {",
                                    "    var obx = jsonData.entry.find(e => e.resource.resourceType === 'Observation');",
                                    "    pm.expect(obx).to.not.be.undefined;",
                                    "    pm.expect(obx.resource.code.coding[0].code).to.eql('8867-4');",
                                    "    pm.expect(obx.resource.status).to.eql('final');",
                                    "    pm.expect(obx.resource.effectiveDateTime).to.include('2023-01-01');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "text/plain",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "MSH|^~\\&|HIS|RIH|EKG|EkG|199904140038||ADT^A01|{{syncObxId}}|P|2.5\rPID|1||103||CONDORN^JANE\rOBX|1|NM|8867-4^Heart rate^LN||80|/min|||||F|||202301011200"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/v2-to-fhir-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "v2-to-fhir-sync"
                            ]
                        }
                    }
                },
                {
                    "name": "Sync ADT^A01 (Patient + Medication)",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"syncRxeId\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var jsonData = pm.response.json();",
                                    "pm.test(\"Contains MedicationRequest\", function () {",
                                    "    var medReq = jsonData.entry.find(e => e.resource.resourceType === 'MedicationRequest');",
                                    "    pm.expect(medReq).to.not.be.undefined;",
                                    "});",
                                    "pm.test(\"MedicationRequest has medication code\", function () {",
                                    "    var medReq = jsonData.entry.find(e => e.resource.resourceType === 'MedicationRequest');",
                                    "    pm.expect(medReq.resource.medicationCodeableConcept).to.not.be.undefined;",
                                    "    pm.expect(medReq.resource.medicationCodeableConcept.coding[0].code).to.eql('RX12345');",
                                    "    pm.expect(medReq.resource.medicationCodeableConcept.coding[0].display).to.eql('Aspirin 81mg');",
                                    "});",
                                    "pm.test(\"MedicationRequest has dosage instructions\", function () {",
                                    "    var medReq = jsonData.entry.find(e => e.resource.resourceType === 'MedicationRequest');",
                                    "    pm.expect(medReq.resource.dosageInstruction).to.be.an('array');",
                                    "    pm.expect(medReq.resource.dosageInstruction.length).to.be.above(0);",
                                    "    pm.expect(medReq.resource.dosageInstruction[0].doseAndRate[0].doseQuantity.value).to.eql(81);",
                                    "    pm.expect(medReq.resource.dosageInstruction[0].doseAndRate[0].doseQuantity.unit).to.eql('mg');",
                                    "});",
                                    "pm.test(\"MedicationRequest has dispense request\", function () {",
                                    "    var medReq = jsonData.entry.find(e => e.resource.resourceType === 'MedicationRequest');",
                                    "    pm.expect(medReq.resource.dispenseRequest).to.not.be.undefined;",
                                    "    pm.expect(medReq.resource.dispenseRequest.quantity.value).to.eql(30);",
                                    "    pm.expect(medReq.resource.dispenseRequest.numberOfRepeatsAllowed).to.eql(3);",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "text/plain",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "MSH|^~\\&|HIS|RIH|EKG|EkG|199904140038||ADT^A01|{{syncRxeId}}|P|2.5\rPID|1||104||MEDICATION^TEST||19900101|M\rRXE|1|RX12345^Aspirin 81mg|81||mg||Take with food|||30|tablets|3"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/v2-to-fhir-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "v2-to-fhir-sync"
                            ]
                        }
                    }
                },
                {
                    "name": "Sync Bundle (Complex HL7)",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"complexHl7Id\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var jsonData = pm.response.json();",
                                    "",
                                    "pm.test(\"Contains Patient\", function () {",
                                    "    var patient = jsonData.entry.find(e => e.resource.resourceType === 'Patient');",
                                    "    pm.expect(patient).to.not.be.undefined;",
                                    "    pm.expect(patient.resource.name[0].family).to.include('DOE');",
                                    "    pm.expect(patient.resource.birthDate).to.eql('1980-02-15');",
                                    "    pm.expect(patient.resource.gender).to.eql('male');",
                                    "    pm.expect(patient.resource.deceasedBoolean).to.be.undefined;",
                                    "});",
                                    "",
                                    "pm.test(\"Contains Encounter with Admit Reason\", function () {",
                                    "    var encounter = jsonData.entry.find(e => e.resource.resourceType === 'Encounter');",
                                    "    pm.expect(encounter).to.not.be.undefined;",
                                    "    pm.expect(encounter.resource.reasonCode).to.not.be.undefined;",
                                    "    pm.expect(encounter.resource.reasonCode).to.be.an('array');",
                                    "    pm.expect(encounter.resource.reasonCode[0].text).to.eql('CHEST PAIN');",
                                    "});",
                                    "",
                                    "pm.test(\"Contains NextOfKin\", function () {",
                                    "    var patient = jsonData.entry.find(e => e.resource.resourceType === 'Patient');",
                                    "    pm.expect(patient.resource.contact).to.have.lengthOf(2);",
                                    "});",
                                    "",
                                    "pm.test(\"Contains Observations\", function () {",
                                    "    var start = jsonData.entry.filter(e => e.resource.resourceType === 'Observation');",
                                    "    pm.expect(start).to.have.length.above(4);",
                                    "    var temp = start.find(o => o.resource.code.coding[0].code === '8310-5');",
                                    "    pm.expect(temp).to.not.be.undefined;",
                                    "    pm.expect(temp.resource.valueQuantity.value).to.eql(98.6);",
                                    "    pm.expect(temp.resource.effectiveDateTime).to.include('2026-01-15T19:20');",
                                    "});",
                                    "",
                                    "pm.test(\"Contains Allergies\", function () {",
                                    "    var allergies = jsonData.entry.filter(e => e.resource.resourceType === 'AllergyIntolerance');",
                                    "    pm.expect(allergies).to.have.lengthOf(2);",
                                    "    var drugAllergy = allergies.find(a => a.resource.code.coding[0].display === 'Aspirin');",
                                    "    pm.expect(drugAllergy.resource.reaction[0].severity).to.eql('severe');",
                                    "});",
                                    "",
                                    "pm.test(\"Contains Conditions\", function () {",
                                    "    var conditions = jsonData.entry.filter(e => e.resource.resourceType === 'Condition');",
                                    "    pm.expect(conditions).to.have.lengthOf(2);",
                                    "});",
                                    "",
                                    "pm.test(\"Contains Procedures\", function () {",
                                    "    var procedures = jsonData.entry.filter(e => e.resource.resourceType === 'Procedure');",
                                    "    pm.expect(procedures).to.have.length.above(0);",
                                    "    pm.expect(procedures[0].resource.performedDateTime).to.include('2026-01-15');",
                                    "});",
                                    "",
                                    "pm.test(\"Contains Patient Details (Race/Ethnicity/Religion/PCP)\", function () {",
                                    "    var patient = jsonData.entry.find(e => e.resource && e.resource.resourceType === 'Patient');",
                                    "    pm.expect(patient, \"Patient not found in bundle\").to.not.be.undefined;",
                                    "    console.log(\"Found Patient GP:\", JSON.stringify(patient.resource.generalPractitioner));",
                                    "    var extensions = (patient.resource && patient.resource.extension) || [];",
                                    "    pm.expect(extensions.some(ext => ext.url && ext.url.includes('race')), \"Race extension missing\").to.be.true;",
                                    "    pm.expect(extensions.some(ext => ext.url && ext.url.includes('ethnicity')), \"Ethnicity extension missing\").to.be.true;",
                                    "    pm.expect(extensions.some(ext => ext.url && ext.url.includes('religion')), \"Religion extension missing\").to.be.true;",
                                    "    var gp = (patient.resource && patient.resource.generalPractitioner) || [];",
                                    "    pm.expect(gp.some(g => (g.display && g.display.includes('FAMILY CLINIC')) || (g.reference && g.reference.includes('FAMILY CLINIC'))), \"PCP missing or display/ref incorrect\").to.be.true;",
                                    "});",
                                    "",
                                    "pm.test(\"Contains Encounter Details (Location/Participants)\", function () {",
                                    "    var encounter = jsonData.entry.find(e => e.resource && e.resource.resourceType === 'Encounter');",
                                    "    pm.expect(encounter && encounter.resource, \"Encounter resource missing\").to.not.be.undefined;",
                                    "    console.log(\"Found Encounter Location:\", JSON.stringify(encounter.resource.location));",
                                    "    var locations = encounter.resource.location || [];",
                                    "    pm.expect(locations.length, \"Encounter location missing\").to.be.above(0);",
                                    "    pm.expect(locations[0].location && locations[0].location.display).to.include('4N 401');",
                                    "    pm.expect(encounter.resource.participant).to.have.length.above(1);",
                                    "});",
                                    "",
                                    "pm.test(\"Contains Quality Observations\", function () {",
                                    "    var start = jsonData.entry.filter(e => e.resource.resourceType === 'Observation');",
                                    "    var temp = start.find(o => o.resource.code.coding[0].code === '8310-5');",
                                    "    pm.expect(temp.resource.effectiveDateTime).to.include('2026-01-15T19:20');",
                                    "});",
                                    "",
                                    "pm.test(\"Contains Insurance\", function () {",
                                    "    var coverage = jsonData.entry.find(e => e.resource.resourceType === 'Coverage');",
                                    "    pm.expect(coverage).to.not.be.undefined;",
                                    "    pm.expect(coverage.resource.subscriberId).to.eql('POL789456');",
                                    "});",
                                    "",
                                    "pm.test(\"Contains Guarantor\", function () {",
                                    "    var related = jsonData.entry.find(e => e.resource.resourceType === 'RelatedPerson');",
                                    "    pm.expect(related).to.not.be.undefined;",
                                    "    pm.expect(related.resource.name[0].family).to.include('DOE');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "text/plain",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "MSH|^~\\&|SENDING_APP|SENDING_FACILITY|RECEIVING_APP|RECEIVING_FACILITY|20260115192700||ADT^A01^ADT_A01|{{complexHl7Id}}|P|2.5|||||USA||EN\rEVN|A01|20260115192500\rPID|1||MRN123456^^^HOSPITAL^MR||DOE^JOHN^MIDDLE^JR^DR|MAIDEN^MOTHER|19800215|M||2106-3^White^HL70005|123 MAIN ST^^MUMBAI^MAHARASHTRA^400001^IND^H^^NAGPUR||(022)1234567^PRN^PH^^^022^1234567~(098)7654321^WPN^CP|||M|HINDU|ACC789456|||N|USA||Y|2\rPD1||||FAMILY CLINIC^^12345|||||Y|||||Y||N|20260101\rNK1|1|DOE^JANE^M|SPO^Spouse^HL70063|456 OAK AVE^^NAGPUR^^440001^IND|(0712)2345678^PRN^PH|(0712)2345679^WPN^PH|EC^Emergency Contact^HL70131~FI^Financial^HL70131|||||||||||||||||||||||||ENG^English^ISO639\rNK1|2|DOE^ROBERT^L|FTH^Father^HL70063|789 ELM ST^^KOLKATA^^700001^IND|(033)3456789^PRN^PH||NOK^Next of Kin^HL70131\rPV1|1|I|4N^401^01^HOSPITAL^^^BED^401^BED|E|||123456^SMITH^JOHN^A^DR^MD^^^^^PROVIDER|234567^JONES^MARY^B^DR^MD^^^^^ATTENDING|567890^BROWN^ROBERT^C^DR^MD^^^^^CONSULTING|||SUR||||ADM|INS123456|||||||||||||||||||||||||||||20260115190000\rPV2|||^CHEST PAIN|||||20260115184500|20260115190000|||||||||||N||||||||||||A|N|||20260115200000\rOBX|1|NM|8310-5^Body Temperature^LN||98.6|F^Fahrenheit^UCUM|||||F|||20260115192000\rOBX|2|NM|8867-4^Heart Rate^LN||72|/min^per minute^UCUM|60-100||||F|||20260115192000\rOBX|3|NM|8480-6^Systolic Blood Pressure^LN||120|mm[Hg]^millimeters of mercury^UCUM|90-140||||F|||20260115192000\rOBX|4|NM|8462-4^Diastolic Blood Pressure^LN||80|mm[Hg]^millimeters of mercury^UCUM|60-90||||F|||20260115192000\rOBX|5|ST|8302-2^Body Height^LN||175|cm^centimeters^UCUM|||||F|||20260115192000\rAL1|1|DA^Drug Allergy^HL70127|1191^Aspirin^RxNorm|SV^Severe^HL70128|Anaphylaxis~Hives|20200101\rAL1|2|FA^Food Allergy^HL70127|227037^Peanuts^SNOMED|MO^Moderate^HL70128|Swelling\rDG1|1||I21.9^Acute Myocardial Infarction^ICD10|Acute Myocardial Infarction||A|||||||||1\rDG1|2||E11.9^Type 2 Diabetes Mellitus^ICD10|Type 2 Diabetes||W|||||||||2\rPR1|1||36.06^Coronary Angioplasty^ICD9PROC|Percutaneous Coronary Intervention|20260115200000|DR^Doctor^HL70230|60|MIN|U|123456^SMITH^JOHN^A^DR^MD\rGT1|1||DOE^JOHN^MIDDLE^JR^DR|MAIDEN^MOTHER|123 MAIN ST^^MUMBAI^MAHARASHTRA^400001^IND|(022)1234567^PRN^PH~(098)7654321^WPN^CP||||19800215|M||SELF|SSN987654321|EMPLOYER NAME|456 WORK AVE^^MUMBAI^MAHARASHTRA^400002^IND|(022)5555555|||||SELF EMPLOYED\rIN1|1|PPO123|INSCO001|INSURANCE COMPANY||||||||||||||||||||||||||||||||POL789456\rIN2||SSN987654321||||||||||||||||||||||||||||||||||||||||||||||||||||(022)1234567\rZPI|CUSTOM FIELD 1|CUSTOM FIELD 2|ADDITIONAL DATA"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/v2-to-fhir-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "v2-to-fhir-sync"
                            ]
                        }
                    }
                },
                {
                    "name": "Sync Bad HL7",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 400\", function () {",
                                    "    pm.response.to.have.status(400);",
                                    "});",
                                    "pm.test(\"Response contains error\", function () {",
                                    "    var jsonData = pm.response.json();",
                                    "    pm.expect(jsonData.error).to.not.be.undefined;",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "text/plain",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "INVALID HEADER|..."
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/v2-to-fhir-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "v2-to-fhir-sync"
                            ]
                        }
                    }
                },
                {
                    "name": "Custom Z-Segment Conversion",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var jsonData = pm.response.json();",
                                    "pm.test(\"Contains Pet Name Extension\", function () {",
                                    "    var hasPet = jsonData.entry[0].resource.extension.some(e => e.url.includes(\"pet-name\") && e.valueString === \"Fluffy\");",
                                    "    pm.expect(hasPet).to.be.true;",
                                    "});",
                                    "pm.test(\"Contains VIP Level Extension\", function () {",
                                    "    var hasVIP = jsonData.entry[0].resource.extension.some(e => e.url.includes(\"vip-level\") && e.valueString === \"VIP-Gold\");",
                                    "    pm.expect(hasVIP).to.be.true;",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "text/plain",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "MSH|^~\\&|HIS|RIH|EKG|EkG|199904140038||ADT^A01|1002|P|2.5\r\nPID|1||100||DOE^JANE||19700101|F\r\nZPI|1|Fluffy|VIP-Gold|Active"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/v2-to-fhir-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "v2-to-fhir-sync"
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "FHIR to HL7 Conversions",
            "item": [
                {
                    "name": "Async Bundle to HL7",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"asyncBundleId\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 202\", function () {",
                                    "    pm.response.to.have.status(202);",
                                    "});",
                                    "pm.test(\"Response body indicates async processing\", function () {",
                                    "    var jsonData = pm.response.json();",
                                    "    pm.expect(jsonData.message).to.eql(\"Processing asynchronously\");",
                                    "    var expectedId = pm.environment.get(\"asyncBundleId\");",
                                    "    pm.expect(jsonData.transactionId).to.eql(expectedId);",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"resourceType\": \"Bundle\",\n  \"id\": \"{{asyncBundleId}}\",\n  \"type\": \"transaction\",\n  \"entry\": [\n    {\n      \"resource\": {\n        \"resourceType\": \"Patient\",\n        \"identifier\": [ { \"value\": \"{{$guid}}\" } ],\n        \"name\": [ { \"family\": \"SKYWALKER\", \"given\": [\"LUKE\"] } ],\n        \"gender\": \"male\"\n      }\n    }\n  ]\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/fhir-to-v2",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "fhir-to-v2"
                            ]
                        },
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Bundle (Patient + Encounter)",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"syncBundleId\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var textData = pm.response.text();",
                                    "pm.test(\"Contains MSH, PID, PV1\", function () {",
                                    "    pm.expect(textData).to.include(\"MSH|\");",
                                    "    pm.expect(textData).to.include(\"PID|\");",
                                    "    pm.expect(textData).to.include(\"PV1|\");",
                                    "});",
                                    "pm.test(\"MSH-10 Matches Bundle ID\", function () {",
                                    "    var expectedId = pm.environment.get(\"syncBundleId\");",
                                    "    pm.expect(textData).to.include(\"|\" + expectedId + \"|\");",
                                    "});",
                                    "pm.test(\"Contains Patient Data\", function () {",
                                    "    pm.expect(textData).to.include(\"SMITH\");",
                                    "});",
                                    "pm.test(\"Contains Visit Num\", function () {",
                                    "    pm.expect(textData).to.include(\"VISIT-001\");",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"resourceType\": \"Bundle\",\n  \"id\": \"{{syncBundleId}}\",\n  \"type\": \"transaction\",\n  \"entry\": [\n    {\n      \"resource\": {\n        \"resourceType\": \"Patient\",\n        \"identifier\": [ { \"value\": \"12345\" } ],\n        \"name\": [ { \"family\": \"SMITH\", \"given\": [\"JOHN\"] } ],\n        \"gender\": \"male\"\n      }\n    },\n    {\n      \"resource\": {\n        \"resourceType\": \"Encounter\",\n        \"identifier\": [ { \"value\": \"VISIT-001\" } ],\n        \"class\": { \"code\": \"I\" }\n      }\n    }\n  ]\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/fhir-to-v2-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "fhir-to-v2-sync"
                            ]
                        },
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Sync Bundle (Patient + Observations)",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"syncObxId\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var textData = pm.response.text();",
                                    "pm.test(\"Contains OBX Segments\", function () {",
                                    "    pm.expect(textData).to.include(\"OBX|1|NM|8867-4\");",
                                    "    pm.expect(textData).to.include(\"OBX|2|NM|8310-5\");",
                                    "});",
                                    "pm.test(\"Contains Values\", function () {",
                                    "    pm.expect(textData).to.include(\"|70|bpm\");",
                                    "    pm.expect(textData).to.include(\"|36.5|C\");",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"resourceType\": \"Bundle\",\n  \"id\": \"{{syncObxId}}\",\n  \"type\": \"transaction\",\n  \"entry\": [\n    {\n      \"resource\": {\n        \"resourceType\": \"Patient\",\n        \"id\": \"pat-1\",\n        \"identifier\": [ { \"value\": \"12345\" } ],\n        \"name\": [ { \"family\": \"SMITH\", \"given\": [\"JOHN\"] } ],\n        \"gender\": \"male\"\n      }\n    },\n    {\n      \"resource\": {\n        \"resourceType\": \"Observation\",\n        \"status\": \"final\",\n        \"code\": { \"coding\": [ { \"system\": \"http://loinc.org\", \"code\": \"8867-4\", \"display\": \"Heart Rate\" } ] },\n        \"subject\": { \"reference\": \"Patient/pat-1\" },\n        \"valueQuantity\": { \"value\": 70, \"unit\": \"bpm\", \"system\": \"http://unitsofmeasure.org\", \"code\": \"/min\" }\n      }\n    },\n    {\n      \"resource\": {\n        \"resourceType\": \"Observation\",\n        \"status\": \"final\",\n        \"code\": { \"coding\": [ { \"system\": \"http://loinc.org\", \"code\": \"8310-5\", \"display\": \"Body Temperature\" } ] },\n        \"subject\": { \"reference\": \"Patient/pat-1\" },\n        \"valueQuantity\": { \"value\": 36.5, \"unit\": \"C\", \"system\": \"http://unitsofmeasure.org\", \"code\": \"Cel\" }\n      }\n    }\n  ]\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/fhir-to-v2-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "fhir-to-v2-sync"
                            ]
                        },
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Sync Bundle (Patient + Allergy)",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"syncAl1Id\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var textData = pm.response.text();",
                                    "pm.test(\"Contains AL1 Segment\", function () {",
                                    "    pm.expect(textData).to.include(\"AL1|1|DA|Z88.1^Penicillin\");",
                                    "});",
                                    "pm.test(\"Contains Reaction\", function () {",
                                    "    pm.expect(textData).to.include(\"|Hives\");",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"resourceType\": \"Bundle\",\n  \"id\": \"{{syncAl1Id}}\",\n  \"type\": \"transaction\",\n  \"entry\": [\n    {\n      \"resource\": {\n        \"resourceType\": \"Patient\",\n        \"id\": \"pat-1\",\n        \"name\": [ { \"family\": \"SMITH\" } ]\n      }\n    },\n    {\n      \"resource\": {\n        \"resourceType\": \"AllergyIntolerance\",\n        \"clinicalStatus\": { \"coding\": [ { \"system\": \"http://terminology.hl7.org/CodeSystem/allergyintolerance-clinical\", \"code\": \"active\" } ] },\n        \"verificationStatus\": { \"coding\": [ { \"system\": \"http://terminology.hl7.org/CodeSystem/allergyintolerance-verification\", \"code\": \"confirmed\" } ] },\n        \"category\": [ \"medication\" ],\n        \"code\": { \"coding\": [ { \"system\": \"http://hl7.org/fhir/sid/icd-10\", \"code\": \"Z88.1\", \"display\": \"Penicillin\" } ] },\n        \"patient\": { \"reference\": \"Patient/pat-1\" },\n        \"reaction\": [ { \"manifestation\": [ { \"text\": \"Hives\" } ] } ]\n      }\n    }\n  ]\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/fhir-to-v2-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "fhir-to-v2-sync"
                            ]
                        },
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Sync Bundle (Patient + Condition)",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"syncDg1Id\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var textData = pm.response.text();",
                                    "pm.test(\"Contains DG1 Segment\", function () {",
                                    "    pm.expect(textData).to.include(\"DG1|1||E11.9\");",
                                    "});",
                                    "pm.test(\"Contains Diagnosis Name\", function () {",
                                    "    pm.expect(textData).to.include(\"Type 2 diabetes\");",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"resourceType\": \"Bundle\",\n  \"id\": \"{{syncDg1Id}}\",\n  \"type\": \"transaction\",\n  \"entry\": [\n    {\n      \"resource\": {\n        \"resourceType\": \"Patient\",\n        \"id\": \"pat-1\",\n        \"identifier\": [ { \"value\": \"12345\" } ],\n        \"name\": [ { \"family\": \"SMITH\", \"given\": [\"JOHN\"] } ],\n        \"gender\": \"male\"\n      }\n    },\n    {\n      \"resource\": {\n        \"resourceType\": \"Condition\",\n        \"code\": { \"coding\": [ { \"system\": \"http://hl7.org/fhir/sid/icd-10\", \"code\": \"E11.9\", \"display\": \"Type 2 diabetes mellitus without complications\" } ] },\n        \"subject\": { \"reference\": \"Patient/pat-1\" },\n        \"category\": [ { \"coding\": [ { \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\", \"code\": \"encounter-diagnosis\", \"display\": \"Admitting Diagnosis\" } ] } ]\n      }\n    }\n  ]\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/fhir-to-v2-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "fhir-to-v2-sync"
                            ]
                        },
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Sync Bundle (Patient + NK1)",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"syncNk1Id\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var textData = pm.response.text();",
                                    "pm.test(\"Contains NK1 Segment\", function () {",
                                    "    pm.expect(textData).to.include(\"NK1|1|DOE^JANE\");",
                                    "});",
                                    "pm.test(\"Contains Relationship\", function () {",
                                    "    pm.expect(textData).to.include(\"|MTH^Mother\");",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"resourceType\": \"Bundle\",\n  \"id\": \"{{syncNk1Id}}\",\n  \"type\": \"transaction\",\n  \"entry\": [\n    {\n      \"resource\": {\n        \"resourceType\": \"Patient\",\n        \"id\": \"pat-1\",\n        \"name\": [ { \"family\": \"SMITH\" } ],\n        \"contact\": [\n          {\n            \"relationship\": [ { \"coding\": [ { \"system\": \"http://terminology.hl7.org/CodeSystem/v2-0063\", \"code\": \"MTH\", \"display\": \"Mother\" } ] } ],\n            \"name\": { \"family\": \"DOE\", \"given\": [ \"JANE\" ] },\n            \"telecom\": [ { \"system\": \"phone\", \"value\": \"555-555-5555\" } ]\n          }\n        ]\n      }\n    }\n  ]\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/fhir-to-v2-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "fhir-to-v2-sync"
                            ]
                        },
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Sync Bundle (Patient + Coverage)",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"syncIn1Id\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var textData = pm.response.text();",
                                    "pm.test(\"Contains IN1 Segment\", function () {",
                                    "    pm.expect(textData).to.include(\"IN1|1||org-1|BlueCross\");",
                                    "});",
                                    "pm.test(\"Contains Policy Number\", function () {",
                                    "    pm.expect(textData).to.include(\"|POL-999\");",
                                    "});",
                                    "pm.test(\"Contains Plan Type\", function () {",
                                    "    pm.expect(textData).to.include(\"P1001\");",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"resourceType\": \"Bundle\",\n  \"id\": \"{{syncIn1Id}}\",\n  \"type\": \"transaction\",\n  \"entry\": [\n    {\n      \"resource\": {\n        \"resourceType\": \"Patient\",\n        \"id\": \"pat-1\",\n        \"name\": [ { \"family\": \"SMITH\" } ]\n      }\n    },\n    {\n      \"resource\": {\n        \"resourceType\": \"Coverage\",\n        \"status\": \"active\",\n        \"subscriberId\": \"POL-999\",\n        \"payor\": [ { \"reference\": \"Organization/org-1\", \"display\": \"BlueCross\" } ],\n        \"beneficiary\": { \"reference\": \"Patient/pat-1\" },\n        \"type\": { \"coding\": [ { \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\", \"code\": \"P1001\" } ] }\n      }\n    },\n    {\n      \"resource\": {\n        \"resourceType\": \"Organization\",\n        \"id\": \"org-1\",\n        \"name\": \"BlueCross\",\n        \"identifier\": [ { \"value\": \"45678\" } ]\n      }\n    }\n  ]\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/fhir-to-v2-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "fhir-to-v2-sync"
                            ]
                        },
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Sync Bundle (Patient + Procedure)",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"syncPr1Id\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var textData = pm.response.text();",
                                    "pm.test(\"Contains PR1 Segment\", function () {",
                                    "    pm.expect(textData).to.include(\"PR1|1||80.1^Appendectomy\");",
                                    "});",
                                    "pm.test(\"Contains Date\", function () {",
                                    "    pm.expect(textData).to.include(\"202301011200\");",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"resourceType\": \"Bundle\",\n  \"id\": \"{{syncPr1Id}}\",\n  \"type\": \"transaction\",\n  \"entry\": [\n    {\n      \"resource\": {\n        \"resourceType\": \"Patient\",\n        \"id\": \"pat-1\",\n        \"name\": [ { \"family\": \"SMITH\" } ]\n      }\n    },\n    {\n      \"resource\": {\n        \"resourceType\": \"Procedure\",\n        \"status\": \"completed\",\n        \"subject\": { \"reference\": \"Patient/pat-1\" },\n        \"code\": { \"coding\": [ { \"system\": \"http://www.ama-assn.org/go/cpt\", \"code\": \"80.1\", \"display\": \"Appendectomy\" } ] },\n        \"performedDateTime\": \"2023-01-01T12:00:00Z\"\n      }\n    }\n  ]\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/fhir-to-v2-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "fhir-to-v2-sync"
                            ]
                        },
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Sync Bundle (Patient + Guarantor)",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"syncGt1Id\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var textData = pm.response.text();",
                                    "pm.test(\"Contains GT1 Segment\", function () {",
                                    "    pm.expect(textData).to.include(\"GT1|1||SMITH^JOHN\");",
                                    "});",
                                    "pm.test(\"Contains Relationship\", function () {",
                                    "    pm.expect(textData).to.include(\"|GT\");",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"resourceType\": \"Bundle\",\n  \"id\": \"{{syncGt1Id}}\",\n  \"type\": \"transaction\",\n  \"entry\": [\n    {\n      \"resource\": {\n        \"resourceType\": \"Patient\",\n        \"id\": \"pat-1\",\n        \"name\": [ { \"family\": \"SMITH\" } ]\n      }\n    },\n    {\n      \"resource\": {\n        \"resourceType\": \"RelatedPerson\",\n        \"patient\": { \"reference\": \"Patient/pat-1\" },\n        \"name\": [ { \"family\": \"SMITH\", \"given\": [ \"JOHN\" ] } ],\n        \"relationship\": [ { \"coding\": [ { \"system\": \"http://terminology.hl7.org/CodeSystem/v2-0063\", \"code\": \"GT\" } ] } ]\n      }\n    }\n  ]\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/fhir-to-v2-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "fhir-to-v2-sync"
                            ]
                        },
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Sync Bundle (Patient Only)",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"syncBundlePatientId\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var textData = pm.response.text();",
                                    "pm.test(\"Contains PID\", function () {",
                                    "    pm.expect(textData).to.include(\"PID|\");",
                                    "});",
                                    "pm.test(\"MSH-10 Matches Bundle ID\", function () {",
                                    "    var expectedId = pm.environment.get(\"syncBundlePatientId\");",
                                    "    pm.expect(textData).to.include(\"|\" + expectedId + \"|\");",
                                    "});",
                                    "pm.test(\"Verify PV1 is empty/minimal or absent data\", function () {",
                                    "    // Since we know the code forces ADT^A01, PV1 might form but checks for values\n    pm.expect(textData).to.not.include(\"VISIT-001\");\n});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"resourceType\": \"Bundle\",\n  \"id\": \"{{syncBundlePatientId}}\",\n  \"type\": \"transaction\",\n  \"entry\": [\n    {\n      \"resource\": {\n        \"resourceType\": \"Patient\",\n        \"identifier\": [ { \"value\": \"99999\" } ],\n        \"name\": [ { \"family\": \"SOLO\", \"given\": [\"HAN\"] } ],\n        \"gender\": \"male\"\n      }\n    }\n  ]\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/fhir-to-v2-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "fhir-to-v2-sync"
                            ]
                        },
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Sync Bundle (Super Complex FHIR)",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"superComplexFhirId\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var hl7 = pm.response.text();",
                                    "pm.test(\"Contains Multiple Names (PID-5)\", function () {",
                                    "    pm.expect(hl7).to.include(\"DOE\");",
                                    "    pm.expect(hl7).to.include(\"JOHN\");",
                                    "    pm.expect(hl7).to.include(\"JOHNNY\");",
                                    "});",
                                    "pm.test(\"Contains Multiple Addresses (PID-11)\", function () {",
                                    "    pm.expect(hl7).to.include(\"123 Main St\");",
                                    "    pm.expect(hl7).to.include(\"456 Work Ave\");",
                                    "    pm.expect(hl7).to.include(\"10001\");",
                                    "    pm.expect(hl7).to.include(\"02110\");",
                                    "});",
                                    "pm.test(\"Contains Multiple Telecoms (PID-13/14)\", function () {",
                                    "    pm.expect(hl7).to.include(\"555-1212\");",
                                    "    pm.expect(hl7).to.include(\"john.doe@example.com\");",
                                    "    pm.expect(hl7).to.include(\"555-3434\");",
                                    "});",
                                    "pm.test(\"Contains Encounter Details (PV1/PV2/Location)\", function () {",
                                    "    pm.expect(hl7).to.include(\"PV1\");",
                                    "    pm.expect(hl7).to.include(\"|I|\");",
                                    "    pm.expect(hl7).to.include(\"WARD 5 ROOM 10-A\");",
                                    "    pm.expect(hl7).to.include(\"DR ATND\");",
                                    "    pm.expect(hl7).to.include(\"DR REFR\");",
                                    "    pm.expect(hl7).to.include(\"DR CON\");",
                                    "    pm.expect(hl7).to.include(\"CHEST PAIN\");",
                                    "});",
                                    "pm.test(\"Contains Patient Details (Race/Ethnicity/PCP)\", function () {",
                                    "    pm.expect(hl7).to.include(\"2106-3\");",
                                    "    pm.expect(hl7).to.include(\"White\");",
                                    "    pm.expect(hl7).to.include(\"2186-5\");",
                                    "    pm.expect(hl7).to.include(\"dr-pcp\");",
                                    "    pm.expect(hl7).to.include(\"DR PRIMARY\");",
                                    "});",
                                    "pm.test(\"Contains Mobile Telecom (CP)\", function () {",
                                    "    pm.expect(hl7).to.include(\"555-9999^PRN^CP\");",
                                    "});",
                                    "pm.test(\"Contains Z-Segment (ZPI)\", function () {",
                                    "    // If Z-segment is not yet supported in ADT_A01 structure, this might fail",
                                    "    // For now, let's at least check if the data exists somewhere or skip if not supported",
                                    "    if(hl7.includes(\"ZPI\")) {",
                                    "       pm.expect(hl7).to.include(\"CustomData\");",
                                    "    } else {",
                                    "       console.warn(\"ZPI segment not found in output - structure might not support it\");",
                                    "    }",
                                    "});",
                                    "pm.test(\"Contains Complex Observations (OBX-8/14)\", function () {",
                                    "    pm.expect(hl7).to.include(\"OBX|1|NM|8867-4\");",
                                    "    pm.expect(hl7).to.include(\"|70|bpm\");",
                                    "    pm.expect(hl7).to.include(\"|H|\");",
                                    "    pm.expect(hl7).to.include(\"2026011512\");",
                                    "});",
                                    "pm.test(\"Contains Insurance (IN1)\", function () {",
                                    "    pm.expect(hl7).to.include(\"IN1|1|POL-123\");",
                                    "    pm.expect(hl7).to.include(\"ORG-456\");",
                                    "    pm.expect(hl7).to.include(\"HEALTH PAYOR\");",
                                    "    pm.expect(hl7).to.include(\"SUB-789\");",
                                    "});",
                                    "pm.test(\"Contains Guarantor (GT1)\", function () {",
                                    "    pm.expect(hl7).to.include(\"GT1|1\");",
                                    "    pm.expect(hl7).to.include(\"JANE\");",
                                    "    pm.expect(hl7).to.include(\"SIS\");",
                                    "});",
                                    "pm.test(\"Contains Procedure (PR1)\", function () {",
                                    "    console.log(\"Generated HL7:\", hl7);",
                                    "    pm.expect(hl7).to.include(\"PR1|1\");",
                                    "    pm.expect(hl7).to.include(\"Appendectomy\");",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"resourceType\": \"Bundle\",\n  \"id\": \"{{superComplexFhirId}}\",\n  \"type\": \"transaction\",\n  \"entry\": [\n    {\n      \"resource\": {\n        \"resourceType\": \"Patient\",\n        \"id\": \"pat-123\",\n        \"extension\": [\n          {\n            \"url\": \"http://hl7.org/fhir/us/core/StructureDefinition/us-core-race\",\n            \"extension\": [\n              {\n                \"url\": \"ombCategory\",\n                \"valueCoding\": {\n                  \"system\": \"http://terminology.hl7.org/CodeSystem/v3-Race\",\n                  \"code\": \"2106-3\",\n                  \"display\": \"White\"\n                }\n              }\n            ]\n          },\n          {\n            \"url\": \"http://hl7.org/fhir/us/core/StructureDefinition/us-core-ethnicity\",\n            \"extension\": [\n              {\n                \"url\": \"ombCategory\",\n                \"valueCoding\": {\n                  \"system\": \"http://terminology.hl7.org/CodeSystem/v3-Ethnicity\",\n                  \"code\": \"2186-5\",\n                  \"display\": \"Not Hispanic or Latino\"\n                }\n              }\n            ]\n          },\n          {\n            \"url\": \"http://fhirtransformer.com/fhir/StructureDefinition/hl7-z-segment\",\n            \"valueString\": \"CustomData\"\n          }\n        ],\n        \"identifier\": [\n          { \"system\": \"urn:oid:1.2.3\", \"value\": \"12345\" },\n          { \"system\": \"urn:oid:4.5.6\", \"value\": \"67890\" },\n          { \"system\": \"urn:oid:7.8.9\", \"value\": \"MRN-101\", \"use\": \"official\", \"type\": { \"coding\": [ { \"code\": \"MR\" } ] } }\n        ],\n        \"generalPractitioner\": [ { \"reference\": \"Practitioner/dr-pcp\", \"display\": \"DR PRIMARY\" } ],\n        \"name\": [\n          { \"use\": \"official\", \"family\": \"DOE\", \"given\": [\"JOHN\"] },\n          { \"use\": \"nickname\", \"family\": \"DOE\", \"given\": [\"JOHNNY\"] }\n        ],\n        \"gender\": \"male\",\n        \"birthDate\": \"1990-01-01\",\n        \"address\": [\n          { \"use\": \"home\", \"line\": [\"123 Main St\"], \"city\": \"New York\", \"state\": \"NY\", \"postalCode\": \"10001\", \"country\": \"USA\" },\n          { \"use\": \"work\", \"line\": [\"456 Work Ave\"], \"city\": \"Boston\", \"state\": \"MA\", \"postalCode\": \"02110\", \"country\": \"USA\" }\n        ],\n        \"telecom\": [\n          { \"system\": \"phone\", \"use\": \"home\", \"value\": \"555-1212\" },\n          { \"system\": \"phone\", \"use\": \"mobile\", \"value\": \"555-9999\" },\n          { \"system\": \"email\", \"use\": \"home\", \"value\": \"john.doe@example.com\" },\n          { \"system\": \"phone\", \"use\": \"work\", \"value\": \"555-3434\" }\n        ]\n      }\n    },\n    {\n      \"resource\": {\n        \"resourceType\": \"Encounter\",\n        \"id\": \"enc-999\",\n        \"identifier\": [ { \"value\": \"VISIT-999\" } ],\n        \"status\": \"finished\",\n        \"class\": { \"code\": \"I\" },\n        \"type\": [ { \"coding\": [ { \"code\": \"E\" } ] } ],\n        \"serviceType\": { \"coding\": [ { \"code\": \"SERV-1\" } ] },\n        \"location\": [ { \"location\": { \"display\": \"WARD 5 ROOM 10-A\" } } ],\n        \"participant\": [\n          { \"type\": [ { \"coding\": [ { \"code\": \"ATND\" } ] } ], \"individual\": { \"display\": \"DR ATND\" } },\n          { \"type\": [ { \"coding\": [ { \"code\": \"REFR\" } ] } ], \"individual\": { \"display\": \"DR REFR\" } },\n          { \"type\": [ { \"coding\": [ { \"code\": \"CON\" } ] } ], \"individual\": { \"display\": \"DR CON\" } }\n        ],\n        \"period\": {\n          \"start\": \"2026-01-15T12:00:00Z\",\n          \"end\": \"2026-01-16T12:00:00Z\"\n        },\n        \"reasonCode\": [ { \"text\": \"CHEST PAIN\" } ]\n      }\n    },\n    {\n      \"resource\": {\n        \"resourceType\": \"Observation\",\n        \"status\": \"final\",\n        \"code\": { \"coding\": [ { \"system\": \"http://loinc.org\", \"code\": \"8867-4\", \"display\": \"Heart Rate\" } ] },\n        \"subject\": { \"reference\": \"Patient/pat-123\" },\n        \"effectiveDateTime\": \"2026-01-15T12:05:00Z\",\n        \"valueQuantity\": { \"value\": 70, \"unit\": \"bpm\" },\n        \"interpretation\": [ { \"coding\": [ { \"code\": \"H\" } ] } ]\n      }\n    },\n    {\n      \"resource\": {\n        \"resourceType\": \"Coverage\",\n        \"identifier\": [ { \"value\": \"POL-123\" } ],\n        \"payor\": [ { \"reference\": \"Organization/ORG-456\", \"display\": \"HEALTH PAYOR\" } ],\n        \"subscriberId\": \"SUB-789\",\n        \"relationship\": { \"coding\": [ { \"code\": \"SEL\" } ] },\n        \"period\": { \"start\": \"2026-01-01\", \"end\": \"2026-12-31\" },\n        \"type\": { \"coding\": [ { \"code\": \"HMO\" } ] }\n      }\n    },\n    {\n      \"resource\": {\n        \"resourceType\": \"RelatedPerson\",\n        \"name\": [ { \"family\": \"DOE\", \"given\": [\"JANE\"] } ],\n        \"address\": [ { \"line\": [\"789 Sister Rd\"] } ],\n        \"birthDate\": \"1980-01-01\",\n        \"relationship\": [ { \"coding\": [ { \"code\": \"SIS\" } ] } ]\n      }\n    },\n    {\n      \"resource\": {\n        \"resourceType\": \"Procedure\",\n        \"code\": { \"coding\": [ { \"code\": \"12345\", \"display\": \"Appendectomy\" } ] },\n        \"performedDateTime\": \"2026-01-15T14:00:00Z\"\n      }\n    }\n  ]\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/fhir-to-v2-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "fhir-to-v2-sync"
                            ]
                        },
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Sync Malformed FHIR",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 400\", function () {",
                                    "    pm.response.to.have.status(400);",
                                    "});",
                                    "pm.test(\"Contains Error Message\", function () {",
                                    "    pm.expect(pm.response.text()).to.match(/Error|error/);",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{ \"resourceType\": \"Bundle\", \"broken_json\": "
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/fhir-to-v2-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "fhir-to-v2-sync"
                            ]
                        },
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Sync Non-Bundle FHIR",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 400\", function () {",
                                    "    pm.response.to.have.status(400);",
                                    "});",
                                    "pm.test(\"Contains Error\", function () {",
                                    "    pm.expect(pm.response.text()).to.include(\"Error\");",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"resourceType\": \"Patient\",\n  \"id\": \"123\",\n  \"name\": [ { \"family\": \"TEST\" } ]\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/fhir-to-v2-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "fhir-to-v2-sync"
                            ]
                        },
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "Batch Processing (v1.1.0)",
            "item": [
                {
                    "name": "Batch HL7 to FHIR Conversion",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var jsonData = pm.response.json();",
                                    "pm.test(\"Total messages is 3\", function () {",
                                    "    pm.expect(jsonData.totalMessages).to.eql(3);",
                                    "});",
                                    "pm.test(\"All messages succeeded\", function () {",
                                    "    pm.expect(jsonData.successCount).to.eql(3);",
                                    "    pm.expect(jsonData.failureCount).to.eql(0);",
                                    "});",
                                    "pm.test(\"Contains results array\", function () {",
                                    "    pm.expect(jsonData.results).to.be.an('array');",
                                    "    pm.expect(jsonData.results).to.have.lengthOf(3);",
                                    "});",
                                    "pm.test(\"Each result has processing time\", function () {",
                                    "    jsonData.results.forEach(result => {",
                                    "        pm.expect(result.processingTimeMs).to.be.above(0);",
                                    "    });",
                                    "});",
                                    "pm.test(\"Processing completed in reasonable time\", function () {",
                                    "    pm.expect(jsonData.processingTimeMs).to.be.below(5000);",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"messages\": [\n    \"MSH|^~\\\\&|HIS|RIH|EKG|EkG|199904140038||ADT^A01|BATCH-001|P|2.5\\rPID|1||100||DOE^JOHN||19700101|M\",\n    \"MSH|^~\\\\&|HIS|RIH|EKG|EkG|199904140038||ADT^A01|BATCH-002|P|2.5\\rPID|1||101||DOE^JANE||19800101|F\",\n    \"MSH|^~\\\\&|HIS|RIH|EKG|EkG|199904140038||ADT^A08|BATCH-003|P|2.5\\rPID|1||102||SMITH^ALEX||19900101|M\"\n  ]\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/v2-to-fhir-batch",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "v2-to-fhir-batch"
                            ]
                        }
                    }
                },
                {
                    "name": "Batch FHIR to HL7 Conversion",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var jsonData = pm.response.json();",
                                    "pm.test(\"Total messages is 2\", function () {",
                                    "    pm.expect(jsonData.totalMessages).to.eql(2);",
                                    "});",
                                    "pm.test(\"All messages succeeded\", function () {",
                                    "    pm.expect(jsonData.successCount).to.eql(2);",
                                    "    pm.expect(jsonData.failureCount).to.eql(0);",
                                    "});",
                                    "pm.test(\"Results contain HL7 messages\", function () {",
                                    "    pm.expect(jsonData.results).to.be.an('array');",
                                    "    pm.expect(jsonData.results[0].output).to.include('MSH');",
                                    "    pm.expect(jsonData.results[0].output).to.include('PID');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "[\n  \"{\\\"resourceType\\\":\\\"Bundle\\\",\\\"id\\\":\\\"batch-fhir-1\\\",\\\"type\\\":\\\"transaction\\\",\\\"entry\\\":[{\\\"resource\\\":{\\\"resourceType\\\":\\\"Patient\\\",\\\"id\\\":\\\"pat-batch-1\\\",\\\"name\\\":[{\\\"family\\\":\\\"BATCH\\\",\\\"given\\\":[\\\"TEST1\\\"]}]}}]}\",\n  \"{\\\"resourceType\\\":\\\"Bundle\\\",\\\"id\\\":\\\"batch-fhir-2\\\",\\\"type\\\":\\\"transaction\\\",\\\"entry\\\":[{\\\"resource\\\":{\\\"resourceType\\\":\\\"Patient\\\",\\\"id\\\":\\\"pat-batch-2\\\",\\\"name\\\":[{\\\"family\\\":\\\"BATCH\\\",\\\"given\\\":[\\\"TEST2\\\"]}]}}]}\"\n]"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/fhir-to-v2-batch",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "fhir-to-v2-batch"
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "Z-Segment Support (v1.1.0)",
            "item": [
                {
                    "name": "Sync ADT^A01 with ZPI Segment",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"zpiTestId\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var jsonData = pm.response.json();",
                                    "pm.test(\"Contains Patient\", function () {",
                                    "    var patient = jsonData.entry.find(e => e.resource.resourceType === 'Patient');",
                                    "    pm.expect(patient).to.not.be.undefined;",
                                    "});",
                                    "pm.test(\"Patient has ZPI extensions\", function () {",
                                    "    var patient = jsonData.entry.find(e => e.resource.resourceType === 'Patient');",
                                    "    var extensions = patient.resource.extension || [];",
                                    "    pm.expect(extensions.length).to.be.above(0);",
                                    "});",
                                    "pm.test(\"Pet Name extension exists\", function () {",
                                    "    var patient = jsonData.entry.find(e => e.resource.resourceType === 'Patient');",
                                    "    var petNameExt = patient.resource.extension.find(ext => ext.url.includes('pet-name'));",
                                    "    pm.expect(petNameExt).to.not.be.undefined;",
                                    "    pm.expect(petNameExt.valueString).to.eql('Fluffy');",
                                    "});",
                                    "pm.test(\"VIP Level extension exists\", function () {",
                                    "    var patient = jsonData.entry.find(e => e.resource.resourceType === 'Patient');",
                                    "    var vipExt = patient.resource.extension.find(ext => ext.url.includes('vip-level'));",
                                    "    pm.expect(vipExt).to.not.be.undefined;",
                                    "    pm.expect(vipExt.valueString).to.eql('VIP-Gold');",
                                    "});",
                                    "pm.test(\"Archive Status extension exists\", function () {",
                                    "    var patient = jsonData.entry.find(e => e.resource.resourceType === 'Patient');",
                                    "    var archiveExt = patient.resource.extension.find(ext => ext.url.includes('archive-status'));",
                                    "    pm.expect(archiveExt).to.not.be.undefined;",
                                    "    pm.expect(archiveExt.valueString).to.eql('Active');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "text/plain",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "MSH|^~\\&|HIS|RIH|EKG|EkG|199904140038||ADT^A01|{{zpiTestId}}|P|2.5\rPID|1||200||PETOWNER^JANE||19850101|F\rZPI|1|Fluffy|VIP-Gold|Active"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/v2-to-fhir-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "v2-to-fhir-sync"
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "Timezone Preservation (v1.1.0)",
            "item": [
                {
                    "name": "Sync ADT^A01 with Timezone Offset",
                    "event": [
                        {
                            "listen": "prerequest",
                            "script": {
                                "exec": [
                                    "var uuid = require('uuid');",
                                    "pm.environment.set(\"tzTestId\", uuid.v4());"
                                ],
                                "type": "text/javascript"
                            }
                        },
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var jsonData = pm.response.json();",
                                    "pm.test(\"Contains Patient with birthDate\", function () {",
                                    "    var patient = jsonData.entry.find(e => e.resource.resourceType === 'Patient');",
                                    "    pm.expect(patient).to.not.be.undefined;",
                                    "    pm.expect(patient.resource.birthDate).to.eql('1990-05-15');",
                                    "});",
                                    "pm.test(\"Contains Observation with effectiveDateTime\", function () {",
                                    "    var obs = jsonData.entry.find(e => e.resource.resourceType === 'Observation');",
                                    "    pm.expect(obs).to.not.be.undefined;",
                                    "    pm.expect(obs.resource.effectiveDateTime).to.not.be.undefined;",
                                    "});",
                                    "pm.test(\"Timezone is preserved in effectiveDateTime\", function () {",
                                    "    var obs = jsonData.entry.find(e => e.resource.resourceType === 'Observation');",
                                    "    // Check that the datetime includes timezone offset",
                                    "    pm.expect(obs.resource.effectiveDateTime).to.match(/[+-]\\d{2}:\\d{2}|Z/);",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "text/plain",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "MSH|^~\\&|HIS|RIH|EKG|EkG|199904140038||ADT^A01|{{tzTestId}}|P|2.5\rPID|1||300||TIMEZONE^TEST||19900515|M\rOBX|1|NM|8867-4^Heart rate^LN||75|/min|||||F|||20260117143000-0500"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/convert/v2-to-fhir-sync",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "convert",
                                "v2-to-fhir-sync"
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "Operations",
            "item": [
                {
                    "name": "Health Check",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "pm.test(\"Status is UP\", function () {",
                                    "    var jsonData = pm.response.json();",
                                    "    pm.expect(jsonData.status).to.eql(\"UP\");",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/actuator/health",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "actuator",
                                "health"
                            ]
                        },
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Metrics",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/actuator/metrics",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "actuator",
                                "metrics"
                            ]
                        },
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Caching Performance Check (Tenants)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "pm.test(\"Response is fast (cached < 200ms)\", function () {",
                                    "    pm.expect(pm.response.responseTime).to.be.below(200);",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/api/tenants",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "tenants"
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "Negative & Security Tests",
            "item": [
                {
                    "name": "RBAC: Tenant cannot List Tenants",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 403\", function () {",
                                    "    pm.response.to.have.status(403);",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password123",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "tenant1",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/api/tenants",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "tenants"
                            ]
                        }
                    }
                },
                {
                    "name": "RBAC: Tenant cannot Onboard",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 403\", function () {",
                                    "    pm.response.to.have.status(403);",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password123",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "tenant1",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"tenantId\": \"hacker\",\n    \"password\": \"pass\",\n    \"name\": \"Hacker Tenant\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/tenants/onboard",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "tenants",
                                "onboard"
                            ]
                        }
                    }
                },
                {
                    "name": "Validation: Invalid Onboard Request",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 400\", function () {",
                                    "    pm.response.to.have.status(400);",
                                    "});",
                                    "var jsonData = pm.response.json();",
                                    "pm.test(\"Error is Validation Error\", function () {",
                                    "    pm.expect(jsonData.error).to.eql(\"Validation Error\");",
                                    "});",
                                    "pm.test(\"Contains Details\", function () {",
                                    "    pm.expect(jsonData.details).to.not.be.undefined;",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"tenantId\": \"\",\n    \"password\": \"123\",\n    \"name\": \"\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/tenants/onboard",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "tenants",
                                "onboard"
                            ]
                        }
                    }
                },
                {
                    "name": "NotFound: Delete Non-Existent Tenant",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 404\", function () {",
                                    "    pm.response.to.have.status(404);",
                                    "});",
                                    "var jsonData = pm.response.json();",
                                    "pm.test(\"Error is Not Found\", function () {",
                                    "    pm.expect(jsonData.error).to.eql(\"Not Found\");",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "DELETE",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/api/tenants/invalid-id-999",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "tenants",
                                "invalid-id-999"
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "Tenant Teardown",
            "item": [
                {
                    "name": "Get Tenant Transactions",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "pm.test(\"Returns summary object\", function () {",
                                    "    var jsonData = pm.response.json();",
                                    "    pm.expect(jsonData).to.have.property('totalCount');",
                                    "    pm.expect(jsonData).to.have.property('totalPages');",
                                    "    pm.expect(jsonData).to.have.property('currentPage');",
                                    "    pm.expect(jsonData).to.have.property('statusCounts');",
                                    "    pm.expect(jsonData.statusCounts).to.be.an('object');",
                                    "    pm.expect(jsonData).to.have.property('transactions');",
                                    "    pm.expect(jsonData.transactions).to.be.an('array');",
                                    "    if (jsonData.transactions.length > 0) {",
                                    "        pm.expect(jsonData.transactions[0]).to.have.property('fhirTransformerId');",
                                    "        pm.expect(jsonData.transactions[0]).to.have.property('originalMessageId');",
                                    "        pm.expect(jsonData.transactions[0]).to.have.property('status');",
                                    "    }",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/api/tenants/tenant1/transactions?startDate=2000-01-01T00:00:00&endDate=2100-01-01T00:00:00",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "tenants",
                                "tenant1",
                                "transactions"
                            ],
                            "query": [
                                {
                                    "key": "startDate",
                                    "value": "2000-01-01T00:00:00"
                                },
                                {
                                    "key": "endDate",
                                    "value": "2100-01-01T00:00:00"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Update Tenant",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "var jsonData = pm.response.json();",
                                    "pm.test(\"Name is updated\", function () {",
                                    "    pm.expect(jsonData.name).to.eql(\"Updated Hospital Name\");",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"name\": \"Updated Hospital Name\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/tenants/tenant1",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "tenants",
                                "tenant1"
                            ]
                        }
                    }
                },
                {
                    "name": "Delete Tenant",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "basic",
                            "basic": [
                                {
                                    "key": "password",
                                    "value": "password",
                                    "type": "string"
                                },
                                {
                                    "key": "username",
                                    "value": "admin",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "DELETE",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/api/tenants/tenant1",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "api",
                                "tenants",
                                "tenant1"
                            ]
                        }
                    }
                }
            ]
        }
    ],
    "variable": [
        {
            "key": "baseUrl",
            "value": "http://localhost:8080",
            "type": "string"
        }
    ]
}